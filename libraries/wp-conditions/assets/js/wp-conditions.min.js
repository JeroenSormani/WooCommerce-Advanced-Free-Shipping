"use strict";jQuery(function(i){function c(){i(".wpc-condition-group").repeater({addTrigger:".wpc-condition-add",removeTrigger:".wpc-condition-delete",template:".wpc-condition-template .wpc-condition-wrap",elementWrap:".wpc-condition-wrap",elementsContainer:".wpc-conditions-list",onAddElement:function(t,e,o,n){var a=Math.floor(899999999*Math.random()+1e8);e.find("input[name], select[name]").attr("name",function(t,e){return e.replace("9999",a)||e}),e.find(".wpc-condition[data-id]").attr("data-id",function(t,e){return e.replace("9999",a)||e}),e.find(".wpc-condition-template .wpc-condition[data-id]").attr("data-id","9999"),e.find("[data-group]").attr("data-group",function(t,e){return e.replace("9999",a)||e}),e.find(".repeater-active").removeClass("repeater-active"),c()}})}function o(t,e){var o={action:"wpc_toggle_enabled",id:t,nonce:wpc.nonce};i.post(ajaxurl,o,e)}i(".wpc-conditions").repeater({addTrigger:".wpc-condition-group-add",removeTrigger:".wpc-condition-group .delete",template:".wpc-condition-group-template .wpc-condition-group-wrap",elementWrap:".wpc-condition-group-wrap",elementsContainer:".wpc-condition-groups",onAddElement:function(t,e,o){var n=Math.floor(899999999*Math.random()+1e8);t.find("input[name], select[name]").attr("name",function(t,e){return e.replace("9999",n)||e}),t.find(".wpc-condition[data-id]").attr("data-id",function(t,e){return e.replace("9999",n)||e}),t.find(".wpc-condition-template .wpc-condition[data-id]").attr("data-id","9999"),t.find("[data-group]").attr("data-group",function(t,e){return e.replace("9999",n)||e}),t.find(".repeater-active").removeClass("repeater-active"),c()},removeElement:function(t){t.remove()}}),c(),i(document.body).on("click",".wpc-conditions .duplicate",function(){var t=i(this).parents(".wpc-condition-group-wrap"),o=t.find(".wpc-condition-group").attr("data-group"),e=i(this).parents(".wpc-condition-groups"),n=Math.floor(899999999*Math.random()+1e8);t.find(".enhanced").select2("destroy").removeClass("enhanced");var a=t.clone();i(t).find("select").each(function(t){i(a).find("select").eq(t).val(i(this).val())}),a.find(".wpc-condition-group").attr("data-group",n),a.find("input[name], select[name]").attr("name",function(t,e){return e.replace("conditions["+o+"]","conditions["+n+"]")}),a.find(".repeater-active").removeClass("repeater-active"),e.append(a),i(document.body).trigger("wc-enhanced-select-init"),c(),i("html, body").on("scroll mousedown DOMMouseScroll mousewheel keydown touchmove",function(t){i("html, body").stop().off("scroll mousedown DOMMouseScroll mousewheel keydown touchmove")}),i("body, html").animate({scrollTop:i(a).offset().top-50},750,function(){i("html, body").off("scroll mousedown DOMMouseScroll mousewheel keydown touchmove")})}),i(document.body).on("change",".wpc-condition",function(){var e={action:wpc2.action_prefix+"update_condition_value",id:i(this).attr("data-id"),group:i(this).parents(".wpc-condition-group").attr("data-group"),condition:i(this).val(),nonce:wpc.nonce},o=i(this).parents(".wpc-condition-wrap").first(),n=".wpc-value-field-wrap";o.find(n).html('<span class="wpc-loading" style="width: calc( 42.5% - 75px ); border: 1px solid transparent; display: inline-block;">&nbsp;</span>').block({message:null,overlayCSS:{background:"",opacity:.6}}),i.post(ajaxurl,e,function(t){o.find(n).replaceWith(t),i(document.body).trigger("wc-enhanced-select-init")});var a=o.find(".wpc-operator").val();o.find(".wpc-operator").empty().html(function(){var o=i(this),t=wpc.condition_operators[e.condition]||wpc.condition_operators.default;i.each(t,function(t,e){o.append(i("<option/>").attr("value",t).text(e)),o.val(a).val()||o.val(o.find("option:first").val())})}),o.find(".wpc-description").html(function(){return i('<span class="woocommerce-help-tip" />').attr("data-tip",wpc.condition_descriptions[e.condition]||"")}),i(".tips, .help_tip, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),i("#tiptip_holder").removeAttr("style"),i("#tiptip_arrow").removeAttr("style")}),i(document.body).on("click",".wpc-conditions-post-table .wpc-toggle-enabled",function(t){t.preventDefault();var e=i(this).closest("tr");o(e.attr("data-id"),function(t){"yes"==t.enabled?e.find(".woocommerce-input-toggle").removeClass("woocommerce-input-toggle--disabled").addClass("woocommerce-input-toggle--enabled"):e.find(".woocommerce-input-toggle").removeClass("woocommerce-input-toggle--enabled").addClass("woocommerce-input-toggle--disabled")})}),i(document.body).on("click",".wpc-card .wpc-toggle-enabled",function(t){var e=i(this).parents(".wpc-card");o(i(this).attr("data-id"),function(t){"yes"==t.enabled?e.hide():console.error(error)})}),i(".wpc-conditions-post-table.wpc-sortable-post-table tbody").sortable({items:"tr",handle:".sort",cursor:"move",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style")},update:function(t,e){var o=i(this).closest("table");o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var n={action:"wpc_save_post_order",form:i(this).closest("form").serialize(),nonce:wpc.nonce};i.post(ajaxurl,n,function(t){i(".wpc-conditions-post-table tbody tr:even").addClass("alternate"),i(".wpc-conditions-post-table tbody tr:odd").removeClass("alternate"),o.unblock()})}})});