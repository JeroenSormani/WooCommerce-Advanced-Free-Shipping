"use strict";jQuery(function(a){function c(){a(".wpc-condition-group").repeater({addTrigger:".wpc-condition-add",removeTrigger:".wpc-condition-delete",template:".wpc-condition-template .wpc-condition-wrap",elementWrap:".wpc-condition-wrap",elementsContainer:".wpc-conditions-list",onAddElement:function(t,e,o,n){var i=Math.floor(899999999*Math.random()+1e8);e.find("input[name], select[name]").attr("name",function(t,e){return e.replace("9999",i)||e}),e.find(".wpc-condition[data-id]").attr("data-id",function(t,e){return e.replace("9999",i)||e}),e.find(".wpc-condition-template .wpc-condition[data-id]").attr("data-id","9999"),e.find("[data-group]").attr("data-group",function(t,e){return e.replace("9999",i)||e}),e.find(".repeater-active").removeClass("repeater-active"),c()}})}a(".wpc-conditions").repeater({addTrigger:".wpc-condition-group-add",removeTrigger:".wpc-condition-group .delete",template:".wpc-condition-group-template .wpc-condition-group-wrap",elementWrap:".wpc-condition-group-wrap",elementsContainer:".wpc-condition-groups",onAddElement:function(t,e,o){var n=Math.floor(899999999*Math.random()+1e8);t.find("input[name], select[name]").attr("name",function(t,e){return e.replace("9999",n)||e}),t.find(".wpc-condition[data-id]").attr("data-id",function(t,e){return e.replace("9999",n)||e}),t.find(".wpc-condition-template .wpc-condition[data-id]").attr("data-id","9999"),t.find("[data-group]").attr("data-group",function(t,e){return e.replace("9999",n)||e}),t.find(".repeater-active").removeClass("repeater-active"),c()},removeElement:function(t){t.remove()}}),c(),a(document.body).on("click",".wpc-conditions .duplicate",function(){var t=a(this).parents(".wpc-condition-group-wrap"),o=t.find(".wpc-condition-group").attr("data-group"),e=a(this).parents(".wpc-condition-groups"),n=Math.floor(899999999*Math.random()+1e8);t.find(".enhanced").select2("destroy").removeClass("enhanced");var i=t.clone();a(t).find("select").each(function(t){a(i).find("select").eq(t).val(a(this).val())}),i.find(".wpc-condition-group").attr("data-group",n),i.find("input[name], select[name]").attr("name",function(t,e){return e.replace("conditions["+o+"]","conditions["+n+"]")}),i.find(".repeater-active").removeClass("repeater-active"),e.append(i),a(document.body).trigger("wc-enhanced-select-init"),c(),a("html, body").on("scroll mousedown DOMMouseScroll mousewheel keydown touchmove",function(t){a("html, body").stop().off("scroll mousedown DOMMouseScroll mousewheel keydown touchmove")}),a("body, html").animate({scrollTop:a(i).offset().top-50},750,function(){a("html, body").off("scroll mousedown DOMMouseScroll mousewheel keydown touchmove")})}),a(document.body).on("change",".wpc-condition",function(){var e={action:wpc2.action_prefix+"update_condition_value",id:a(this).attr("data-id"),group:a(this).parents(".wpc-condition-group").attr("data-group"),condition:a(this).val(),nonce:wpc.nonce},o=a(this).parents(".wpc-condition-wrap").first(),n=".wpc-value-field-wrap";o.find(n).html('<span class="wpc-loading" style="width: calc( 42.5% - 75px ); border: 1px solid transparent; display: inline-block;">&nbsp;</span>').block({message:null,overlayCSS:{background:"",opacity:.6}}),a.post(ajaxurl,e,function(t){o.find(n).replaceWith(t),a(document.body).trigger("wc-enhanced-select-init")});var i=o.find(".wpc-operator").val();o.find(".wpc-operator").empty().html(function(){var o=a(this),t=wpc.condition_operators[e.condition]||wpc.condition_operators.default;a.each(t,function(t,e){o.append(a("<option/>").attr("value",t).text(e)),o.val(i).val()||o.val(o.find("option:first").val())})}),o.find(".wpc-description").html(function(){return a('<span class="woocommerce-help-tip" />').attr("data-tip",wpc.condition_descriptions[e.condition]||"")}),a(".tips, .help_tip, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),a("#tiptip_holder").removeAttr("style"),a("#tiptip_arrow").removeAttr("style")}),a(".wpc-conditions-post-table.wpc-sortable-post-table tbody").sortable({items:"tr",handle:".sort",cursor:"move",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style")},update:function(t,e){var o=a(this).closest("table");o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var n={action:"wpc_save_post_order",form:a(this).closest("form").serialize(),nonce:wpc.nonce};a.post(ajaxurl,n,function(t){a(".wpc-conditions-post-table tbody tr:even").addClass("alternate"),a(".wpc-conditions-post-table tbody tr:odd").removeClass("alternate"),o.unblock()})}})});